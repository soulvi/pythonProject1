Практическая работа № 5

Задание 1

Дан файл с некоторыми данными. Формат файла – произвольный. Считайте данные из файла и запишите их в Mongo. Реализуйте и выполните следующие запросы:

вывод* первых 10 записей, отсортированных по убыванию по полю salary;

вывод первых 15 записей, отфильтрованных по предикату age < 30, отсортировать по убыванию по полю salary

вывод первых 10 записей, отфильтрованных по сложному предикату: (записи только из произвольного города, записи только из трех произвольно взятых профессий), отсортировать по возрастанию по полю age

вывод количества записей, получаемых в результате следующей фильтрации (age в произвольном диапазоне, year в [2019,2022], 50 000 < salary <= 75 000 || 125 000 < salary < 150 000).

* – здесь и везде предполагаем вывод в JSON.



Задание 2

Дан файл с некоторыми данными. Формат файла – произвольный, не совпадает с тем, что был в первом задании. Необходимо считать данные и добавить их к той коллекции, куда были записаны данные в первом задании. Реализовать следующие запросы:

вывод минимальной, средней, максимальной salary

вывод количества данных по представленным профессиям

вывод минимальной, средней, максимальной salary по городу

вывод минимальной, средней, максимальной salary по профессии

вывод минимального, среднего, максимального возраста по городу

вывод минимального, среднего, максимального возраста по профессии

вывод максимальной заработной платы при минимальном возрасте

вывод минимальной заработной платы при максимальной возрасте

вывод минимального, среднего, максимального возраста по городу, при условии, что заработная плата больше 50 000, отсортировать вывод по любому полю.

вывод минимальной, средней, максимальной salary в произвольно заданных диапазонах по городу, профессии, и возрасту: 18<age<25 & 50<age<65

произвольный запрос с $match, $group, $sort



Задание 3

Дан файл с некоторыми данными. Формат файла – произвольный, не совпадает с тем, что был в первом/втором заданиях. Необходимо считать данные и добавить их к той коллекции, куда были записаны данные в первом и втором заданиях. Выполните следующие запросы:

удалить из коллекции документы по предикату: salary < 25 000 || salary > 175000

увеличить возраст (age) всех документов на 1

поднять заработную плату на 5% для произвольно выбранных профессий

поднять заработную плату на 7% для произвольно выбранных городов

поднять заработную плату на 10% для выборки по сложному предикату (произвольный город, произвольный набор профессий, произвольный диапазон возраста)

удалить из коллекции записи по произвольному предикату





Задание 4

Самостоятельно выбрать предметную область. Подобрать пару наборов данных разных форматов. Заполнение данных в mongo осуществляем из файлов. Реализовать выполнение по 5 запросов в каждой категорий:

выборка (задание 1),

выбора с агрегацией (задание 2)

обновление/удаление данных (задание 3).